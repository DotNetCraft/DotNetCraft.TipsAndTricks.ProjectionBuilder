name: Auto tag
on:
  push:
    branches:
      - '**'

jobs:
  build:
    name: Create Tag
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4      
      - name: Set PRERELEASE_SUFFIX
        id: prerelease
        run: |
            if [[ "${{ github.ref }}" == "refs/heads/main" || "${{ github.ref }}" == "refs/heads/master" ]]; then
                echo "::set-output name=tag::''"
            elif [[ "${{ github.ref }}" == refs/heads/hotfix/* ]]; then
                echo "::set-output name=tag::hotfix"
            elif [[ "${{ github.ref }}" == refs/heads/feature/* ]]; then
                echo "::set-output name=tag::alpha"
            elif [[ "${{ github.ref }}" == refs/heads/develop/* ]]; then
                echo "::set-output name=tag::beta"
            elif [[ "${{ github.ref }}" == refs/heads/release/* ]]; then                
                echo "::set-output name=tag::release"
            fi                    
      - name: Bump version and push tag 23  
        id: tag_version
        uses: anothrNick/github-tag-action@1.67.0
        env:
            GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
            WITH_V: false
            INITIAL_VERSION: 5.0.1
            DEFAULT_BUMP: patch
            RELEASE_BRANCHES: main
            PRE_RELEASE_BRANCHES: develop,feature/*,release/*,hotfix/*
            TAG_CONTEXT: branch
            PRERELEASE: true
            PRERELEASE_SUFFIX: ${{ steps.prerelease.outputs.tag }}